import sys
import os
import pygame


import end_gif
import game_logic
import leaderboard_utils



# Farben definieren
GREEN = "\033[92m"
RED = "\033[91m"
RESET = "\033[0m"



def play_music():
    """Abspielt die Musik im Hintergrund."""
    pygame.mixer.init()  # Initialisiere den Mixer
    music_path = "/Users/andreweigel/Library/Mobile Documents/com~apple~CloudDocs/beyond_belief_game/music/xxx.wav"  # Pfad zur WAV-Datei
    if os.path.exists(music_path):  # ÃœberprÃ¼fen, ob die Datei existiert
        pygame.mixer.music.load(music_path)  # Lade die WAV-Datei
        pygame.mixer.music.play(-1)  # Spiele die Musik in einer Schleife
    else:
        print(f"{GREEN}Die Datei wurde nicht gefunden: {music_path}{RESET}")


def clear_screen():
    """Clears the screen"""
    # Check if running on Windows terminal
    if os.name == 'nt':
        os.system('cls')
    else:
        # On Unix-like systems, try clear command first
        if 'TERM' in os.environ:
            os.system('clear')
        else:
            # PyCharm built-in console fallback: print many newlines
            print("\n" * 100)



def get_player_name():
    """Asks the user for their name."""
    # Input fÃ¼r den Spielernamen innerhalb eines grÃ¼nen Rahmens
    print(
        f"{GREEN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—")
    player_name = input(f"  {GREEN}State your name as you step into the unknown: {RESET}").strip()

    print(
        f"{GREEN}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")

    print(
        f"  {GREEN}ğŸ•µï¸ Hello {player_name}, now we enter the game of truth and lies.\n     Two truths, one lie... "
        f"but only one chance to uncover it.{RESET}\n"
        f"{GREEN}â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£")

    input("  Press Enter to continue.")
    return player_name


def play_game():
    """Handles the new game flow."""
    player_name = get_player_name()

    total_points = game_logic.play_game()

    if leaderboard_utils.update_leaderboard_if_high_score(player_name, total_points):
        print(f"    {GREEN}NEW HIGHSCORE: {RESET}")
        leaderboard_utils.show_leaderboard()

    clear_screen()
    display_game_over_screen(total_points)

    input("    Press Enter to return to main menu. ")





def quit_game():
    """Exits the game."""
    print(f"{GREEN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—{RESET}")
    print(f"{GREEN}âŒ     The game has been quit. The truth remains, waiting until we meet again.                                  âŒ{RESET}")
    print(f"{GREEN}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•{RESET}")


    end_gif.show_gif()
    sys.exit()



def print_main_menu():
    """Displays the menu options to the user."""
    print(f"{GREEN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—")
    print("â•‘ â–„â–„â–„â–„     â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“  â–ˆâ–ˆ   â–ˆâ–ˆâ–“  â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–€    â–ˆâ–ˆâ–ˆâ–„   â–ˆâ–ˆ   â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„    â–„â–„â–„â–„   â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–“      â–ˆâ–ˆâ–“  â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â•‘")
    print("â•‘ â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„   â–“â–ˆ      â–’â–ˆâ–ˆ  â–ˆâ–ˆâ–’  â–’â–ˆâ–’   â–ˆâ–ˆâ–’  â–ˆâ–ˆ â–€â–ˆ  â–ˆâ–ˆ   â–’â–ˆâ–ˆâ–€ â–ˆâ–ˆâ–Œ  â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„ â–“â–ˆ   â–€  â–“â–ˆâ–ˆâ–’      â–“â–ˆâ–ˆ  â–’â–“â–ˆ      â–“â–ˆâ–ˆ      â•‘")
    print("â•‘ â–’â–ˆâ–ˆâ–’ â–„â–ˆ  â–ˆâ–’â–ˆâ–ˆâ–ˆ     â–’â–ˆâ–ˆ â–ˆâ–ˆâ–‘  â–’â–ˆâ–‘   â–ˆâ–ˆâ–’  â–ˆâ–ˆ  â–€â–ˆ â–ˆâ–’   â–ˆâ–ˆ    â–ˆâ–Œ  â–’â–ˆâ–ˆâ–’ â–„â–ˆ â–ˆâ–’â–ˆâ–ˆâ–ˆ   â–’â–ˆâ–ˆâ–‘      â–’â–ˆâ–ˆ  â–’â–’â–ˆâ–ˆâ–ˆâ–ˆ   â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â•‘")
    print("â•‘ â–’â–ˆâ–ˆâ–‘â–ˆâ–€    â–’â–“â–ˆ  â–„  â–‘ â–â–ˆâ–ˆâ–“â–’   â–ˆâ–ˆ   â–ˆâ–ˆâ–‘â–“  â–ˆâ–’   â–â–Œâ–ˆâ–’   â–“â–ˆâ–„   â–ˆâ–Œ  â–’â–ˆâ–ˆâ–‘â–ˆâ–€  â–’â–“â–ˆ  â–„  â–’â–ˆâ–ˆâ–‘      â–‘â–ˆâ–ˆ  â–‘â–’â–“â–ˆ  â–„  â–‘â–ˆâ–ˆâ–’  â–‘  â•‘")
    print("â•‘ â–‘â–“â–ˆ  â–€â–ˆ  â–“â–‘â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’ â–‘ â–ˆâ–ˆâ–’â–‘    â–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘â–’â–ˆ  â–ˆâ–‘    â–ˆâ–ˆ  â–‘ â–’â–ˆâ–ˆâ–ˆâ–ˆâ–“    â–‘â–“â–ˆ  â–€â–ˆ â–“â–‘â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’ â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’ â–‘â–ˆâ–ˆâ–‘ â–‘â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–’â–ˆâ–ˆâ–‘     â•‘")
    print("â•‘ â–‘â–’â–“â–ˆâ–ˆâ–ˆâ–€  â–’â–‘â–‘ â–’â–‘ â–‘  â–ˆâ–ˆâ–’â–’   â–‘           â–’â–‘                     â–‘â–’â–“â–ˆâ–ˆâ–ˆâ–€ â–’â–‘â–‘ â–’â–‘ â–‘â–‘ â–’â–‘â–“  â–‘â–‘â–“  â–‘â–‘ â–’â–‘ â–‘ â–’ â–‘          â•‘")
    print("â•‘ â–’â–‘â–’   â–‘    â–‘ â–‘  â–‘  â–‘â–’â–‘    â–’    â–‘ â–‘    â–‘ â–’â–‘ â–‘ â–’    â–‘â–’     â–‘  â–‘ â–‘  â–‘â–‘ â–‘ â–’  â–‘ â–’ â–‘ â–‘ â–‘  â–‘ â–‘                       â•‘")
    print("â•‘ â–‘    â–‘      â–‘   â–’ â–’ â–‘â–‘  â–‘   â–‘ â–’     â–‘   â–‘ â–‘  â–‘ â–‘  â–‘   â–‘      â–‘    â–‘     â–‘ â–‘    â–’ â–‘   â–‘    â–‘ â–‘                 â•‘")
    print("â•‘ â–‘           â–‘  â–‘â–‘ â–‘         â–‘ â–‘           â–‘    â–‘      â–‘           â–‘  â–‘    â–‘  â–‘ â–‘     â–‘  â–‘                     â•‘")
    print("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
    print("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—")
    print("â•‘ Welcome to Beyond Belief: Fact or Fiction - The game where knowledge meets instinct                           â•‘")
    print("â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£")
    print("â•‘ Three statements. One is a lie. Will your instincts guide you?                                                â•‘")
    print("â•‘ Behind every fact lies a shadow. Find the one that doesn't belong.                                            â•‘")
    print("â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£")
    print("â•‘ Menu:                                                                                                         â•‘")
    print("â•‘   1. Play Game                                                                                                â•‘")
    print("â•‘   2. Show Leaderboard                                                                                         â•‘")
    print("â•‘   3. Reset Leaderboard                                                                                        â•‘")
    print("â•‘   4. Quit Game                                                                                                â•‘")
    print("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
    print(f"{RESET}")



def evaluate_menu_input(user_input):
    valid_choices = {'1', '2', '3', '4'}
    user_input = user_input.strip()

    if user_input in valid_choices:
        return int(user_input)
    else:
        raise ValueError(f"{GREEN}  Invalid menu option. Please enter a number between 1 and 4.{RESET}")


def display_game_over_screen(points_count):
    ascii_art = f"""{RED}
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    â–„â–„â–„        â–ˆâ–ˆâ–ˆâ–„ â–„â–ˆâ–ˆâ–ˆâ–“ â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–’   â–ˆâ–“â–“ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–€â–ˆâ–ˆâ–„                                 â•‘
â•‘  â–ˆâ–ˆâ–’  â–ˆâ–’  â–’â–ˆâ–ˆâ–ˆâ–ˆâ–„     â–“â–ˆâ–ˆâ–’â–€â–ˆâ–€ â–ˆâ–ˆâ–’ â–“â–ˆ   â–€    â–’â–ˆâ–ˆâ–’  â–ˆâ–ˆâ–’ â–“â–ˆâ–ˆâ–‘   â–ˆâ–’ â–“â–ˆ   â–€ â–“â–ˆâ–ˆ  â–’â–ˆâ–ˆâ–’                               â•‘
â•‘  â–ˆâ–ˆâ–ˆâ–‘â–„â–„â–„  â–’â–ˆâ–ˆ  â–€â–ˆâ–„   â–“â–ˆâ–ˆ    â–“â–ˆâ–ˆâ–‘ â–’â–ˆâ–ˆâ–ˆ      â–’â–ˆâ–ˆâ–‘  â–ˆâ–ˆâ–’ â–“â–ˆâ–ˆ  â–ˆâ–’â–‘ â–’â–ˆâ–ˆâ–ˆ    â–“â–ˆâ–ˆ â–‘â–„â–ˆâ–’                                â•‘
â•‘  â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–“ â–‘â–ˆâ–ˆâ–„â–„â–„â–„â–ˆâ–ˆ  â–’â–ˆâ–ˆ    â–’â–ˆâ–ˆ  â–’â–“â–ˆ  â–„    â–’â–ˆâ–ˆ   â–ˆâ–ˆâ–‘  â–’â–ˆâ–ˆ â–ˆâ–‘ â–‘â–’â–“â–ˆ  â–„  â–’â–ˆâ–ˆâ–€â–€â–ˆâ–„                                 â•‘
â•‘  â–‘â–’â–ˆâ–ˆâ–ˆâ–ˆâ–€â–’  â–“â–ˆ   â–“â–ˆâ–ˆ â–’â–’â–ˆâ–ˆâ–’   â–‘â–ˆâ–ˆâ–’ â–‘â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’   â–‘ â–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘   â–’â–ˆâ–ˆâ–‘  â–‘â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–‘ â–ˆâ–ˆâ–“  â–’â–ˆâ–’                                â•‘
â•‘   â–‘â–’    â–’  â–’â–’   â–“â–’â–ˆ â–‘â–‘ â–’â–‘   â–‘  â–‘â–‘ â–‘ â–’â–‘ â–‘   â–‘ â–’â–‘â–’â–‘â–’â–‘    â–‘â–â–‘   â–‘â–‘ â–’â–‘ â–‘â–‘  â–’â–“ â–‘â–’â–“â–‘                                â•‘
â•‘    â–‘    â–‘   â–’   â–’â–’  â–‘â–‘  â–‘      â–‘ â–‘  â–‘  â–‘     â–‘ â–’ â–’â–‘    â–‘ â–‘â–‘   â–‘ â–‘  â–‘   â–‘â–’ â–‘ â–’â–‘                                â•‘
â•‘  â–‘ â–‘    â–‘   â–‘   â–’    â–‘      â–‘       â–‘      â–‘ â–‘ â–‘ â–’       â–‘â–‘     â–‘      â–‘â–‘   â–‘                                 â•‘
â•‘      â–‘       â–‘   â–‘       â–‘       â–‘  â–‘       â–‘ â–‘        â–‘     â–‘  â–‘   â–‘                                         â•‘
â•‘                                                        â–‘                                                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                         
    {RESET}"""
    print(ascii_art)
    print(f"{GREEN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—")
    print(f"  Your final score: {points_count}                                                                                           ")
    print("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")