import sys
import os
import pygame

import end_gif
import game_logic
import leaderboard_utils

# Terminal color codes
GREEN = "\033[92m"
RED = "\033[91m"
RESET = "\033[0m"

def play_music():
    """Plays background music if the file exists."""
    pygame.mixer.init()
    music_path = "/Users/alinamarcus/Library/Mobile Documents/com~apple~CloudDocs/beyond_belief_game/music/xxx.wav"
    if os.path.exists(music_path):
        pygame.mixer.music.load(music_path)
        pygame.mixer.music.play(-1)
    else:
        print(f"{GREEN}Music file not found at: {music_path}{RESET}")

def clear_screen():
    """Clears the terminal screen."""
    if os.name == 'nt':
        os.system('cls')
    elif 'TERM' in os.environ:
        os.system('clear')
    else:
        print("\n" * 100)

def get_player_name():
    """Prompts the player to enter their name."""
    print(f"{GREEN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—")
    player_name = input(f"  {GREEN}State your name as you step into the unknown: {RESET}").strip()
    print(f"{GREEN}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
    print(
        f"  {GREEN}ğŸ•µï¸ Hello {player_name}, welcome to the game of truth and lies.\n"
        f"     Two truths, one lie... but only one chance to find it.{RESET}\n"
        f"{GREEN}â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£")
    input("  Press Enter to continue.")
    return player_name

def play_game():
    """Starts a new game round."""
    player_name = get_player_name()
    total_points = game_logic.play_game()

    if leaderboard_utils.update_leaderboard_if_high_score(player_name, total_points):
        print(f"    {GREEN}NEW HIGHSCORE!{RESET}")
        leaderboard_utils.show_leaderboard()

    clear_screen()
    display_game_over_screen(total_points)
    input("    Press Enter to return to the main menu. ")

def quit_game():
    """Exits the game with farewell message and animation."""
    print(f"{GREEN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—{RESET}")
    print(f"{GREEN}âŒ     The game has been quit. The truth remains, waiting until we meet again.                                  âŒ{RESET}")
    print(f"{GREEN}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•{RESET}")
    end_gif.show_gif()
    sys.exit()

def print_main_menu():
    """Displays the main menu."""
    print(f"{GREEN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—")
    print("â•‘ â–„â–„â–„â–„     â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“  â–ˆâ–ˆ   â–ˆâ–ˆâ–“  â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–€    â–ˆâ–ˆâ–ˆâ–„   â–ˆâ–ˆ   â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„    â–„â–„â–„â–„   â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–“      â–ˆâ–ˆâ–“  â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â•‘")
    print("â•‘ â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„   â–“â–ˆ      â–’â–ˆâ–ˆ  â–ˆâ–ˆâ–’  â–’â–ˆâ–’   â–ˆâ–ˆâ–’  â–ˆâ–ˆ â–€â–ˆ  â–ˆâ–ˆ   â–’â–ˆâ–ˆâ–€ â–ˆâ–ˆâ–Œ  â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„ â–“â–ˆ   â–€  â–“â–ˆâ–ˆâ–’      â–“â–ˆâ–ˆ  â–’â–“â–ˆ      â–“â–ˆâ–ˆ      â•‘")
    print("â•‘ â–’â–ˆâ–ˆâ–’ â–„â–ˆ  â–ˆâ–’â–ˆâ–ˆâ–ˆ     â–’â–ˆâ–ˆ â–ˆâ–ˆâ–‘  â–’â–ˆâ–‘   â–ˆâ–ˆâ–’  â–ˆâ–ˆ  â–€â–ˆ â–ˆâ–’   â–ˆâ–ˆ    â–ˆâ–Œ  â–’â–ˆâ–ˆâ–’ â–„â–ˆ â–ˆâ–’â–ˆâ–ˆâ–ˆ   â–’â–ˆâ–ˆâ–‘      â–’â–ˆâ–ˆ  â–’â–’â–ˆâ–ˆâ–ˆâ–ˆ   â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â•‘")
    print("â•‘ â–’â–ˆâ–ˆâ–‘â–ˆâ–€    â–’â–“â–ˆ  â–„  â–‘ â–â–ˆâ–ˆâ–“â–’   â–ˆâ–ˆ   â–ˆâ–ˆâ–‘â–“  â–ˆâ–’   â–â–Œâ–ˆâ–’   â–“â–ˆâ–„   â–ˆâ–Œ  â–’â–ˆâ–ˆâ–‘â–ˆâ–€  â–’â–“â–ˆ  â–„  â–’â–ˆâ–ˆâ–‘      â–‘â–ˆâ–ˆ  â–‘â–’â–“â–ˆ  â–„  â–‘â–ˆâ–ˆâ–’  â–‘  â•‘")
    print("â•‘ â–‘â–“â–ˆ  â–€â–ˆ  â–“â–‘â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’ â–‘ â–ˆâ–ˆâ–’â–‘    â–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘â–’â–ˆ  â–ˆâ–‘    â–ˆâ–ˆ  â–‘ â–’â–ˆâ–ˆâ–ˆâ–ˆâ–“    â–‘â–“â–ˆ  â–€â–ˆ â–“â–‘â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’ â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’ â–‘â–ˆâ–ˆâ–‘ â–‘â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–’â–ˆâ–ˆâ–‘     â•‘")
    print("â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£")
    print("â•‘ Welcome to Beyond Belief: Fact or Fiction â€“ The game where knowledge meets instinct                          â•‘")
    print("â•‘ Three statements. One is a lie. Will your instincts guide you?                                               â•‘")
    print("â•‘ Behind every fact lies a shadow. Find the one that doesn't belong.                                           â•‘")
    print("â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£")
    print("â•‘ Menu:                                                                                                        â•‘")
    print("â•‘   1. Play Game                                                                                               â•‘")
    print("â•‘   2. Show Leaderboard                                                                                        â•‘")
    print("â•‘   3. Reset Leaderboard                                                                                       â•‘")
    print("â•‘   4. Quit Game                                                                                               â•‘")
    print("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
    print(f"{RESET}")

def evaluate_menu_input(user_input):
    """Validates and converts the user's menu selection."""
    valid_choices = {'1', '2', '3', '4'}
    user_input = user_input.strip()

    if user_input in valid_choices:
        return int(user_input)
    else:
        raise ValueError(f"{GREEN}  Invalid menu option. Please enter a number between 1 and 4.{RESET}")

def display_game_over_screen(points_count):
    """Displays the game over screen with ASCII art and score."""
    ascii_art = f"""{RED}
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    â–„â–„â–„        â–ˆâ–ˆâ–ˆâ–„ â–„â–ˆâ–ˆâ–ˆâ–“ â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–’   â–ˆâ–“â–“ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–€â–ˆâ–ˆâ–„                                 â•‘
â•‘  â–ˆâ–ˆâ–’  â–ˆâ–’  â–’â–ˆâ–ˆâ–ˆâ–ˆâ–„     â–“â–ˆâ–ˆâ–’â–€â–ˆâ–€ â–ˆâ–ˆâ–’ â–“â–ˆ   â–€    â–’â–ˆâ–ˆâ–’  â–ˆâ–ˆâ–’ â–“â–ˆâ–ˆâ–‘   â–ˆâ–’ â–“â–ˆ   â–€ â–“â–ˆâ–ˆ  â–’â–ˆâ–ˆâ–’                               â•‘
â•‘  â–ˆâ–ˆâ–ˆâ–‘â–„â–„â–„  â–’â–ˆâ–ˆ  â–€â–ˆâ–„   â–“â–ˆâ–ˆ    â–“â–ˆâ–ˆâ–‘ â–’â–ˆâ–ˆâ–ˆ      â–’â–ˆâ–ˆâ–‘  â–ˆâ–ˆâ–’ â–“â–ˆâ–ˆ  â–ˆâ–’â–‘ â–’â–ˆâ–ˆâ–ˆ    â–“â–ˆâ–ˆ â–‘â–„â–ˆâ–’                                â•‘
â•‘  â–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–“ â–‘â–ˆâ–ˆâ–„â–„â–„â–„â–ˆâ–ˆ  â–’â–ˆâ–ˆ    â–’â–ˆâ–ˆ  â–’â–“â–ˆ  â–„    â–’â–ˆâ–ˆ   â–ˆâ–ˆâ–‘  â–’â–ˆâ–ˆ â–ˆâ–‘ â–‘â–’â–“â–ˆ  â–„  â–’â–ˆâ–ˆâ–€â–€â–ˆâ–„                                 â•‘
â•‘  â–‘â–’â–ˆâ–ˆâ–ˆâ–ˆâ–€â–’  â–“â–ˆ   â–“â–ˆâ–ˆ â–’â–’â–ˆâ–ˆâ–’   â–‘â–ˆâ–ˆâ–’ â–‘â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’   â–‘ â–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘   â–’â–ˆâ–ˆâ–‘  â–‘â–’â–ˆâ–ˆâ–ˆâ–ˆâ–’â–‘ â–ˆâ–ˆâ–“  â–’â–ˆâ–’                                â•‘
â•‘   â–‘â–’    â–’  â–’â–’   â–“â–’â–ˆ â–‘â–‘ â–’â–‘   â–‘  â–‘â–‘ â–‘ â–’â–‘ â–‘   â–‘ â–’â–‘â–’â–‘â–’â–‘    â–‘â–â–‘   â–‘â–‘ â–’â–‘ â–‘â–‘  â–’â–“ â–‘â–’â–“â–‘                                â•‘
â•‘    â–‘    â–‘   â–’   â–’â–’  â–‘â–‘  â–‘      â–‘ â–‘  â–‘  â–‘     â–‘ â–’ â–’â–‘    â–‘ â–‘â–‘   â–‘ â–‘  â–‘   â–‘â–’ â–‘ â–’â–‘                                â•‘
â•‘  â–‘ â–‘    â–‘   â–‘   â–’    â–‘      â–‘       â–‘      â–‘ â–‘ â–‘ â–’       â–‘â–‘     â–‘      â–‘â–‘   â–‘                                 â•‘
â•‘      â–‘       â–‘   â–‘       â–‘       â–‘  â–‘       â–‘ â–‘        â–‘     â–‘  â–‘   â–‘                                         â•‘
â•‘                                                        â–‘                                                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                         
{RESET}"""
    print(ascii_art)
    print(f"{GREEN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—")
    print(f"  Your final score: {points_count}")
    print(f"â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•{RESET}")
